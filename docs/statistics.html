<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Statistics | Ksiega Lukasza</title>
  <meta name="description" content="Everything you need (and nothing more) to start a bookdown book." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Statistics | Ksiega Lukasza" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Everything you need (and nothing more) to start a bookdown book." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Statistics | Ksiega Lukasza" />
  
  <meta name="twitter:description" content="Everything you need (and nothing more) to start a bookdown book." />
  

<meta name="author" content="Lukasz Rabalski" />


<meta name="date" content="2021-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-grapling.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Ksiega Lukasza</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="data-grapling.html"><a href="data-grapling.html"><i class="fa fa-check"></i><b>1</b> Data Grapling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-grapling.html"><a href="data-grapling.html#eda"><i class="fa fa-check"></i><b>1.1</b> EDA</a></li>
<li class="chapter" data-level="1.2" data-path="data-grapling.html"><a href="data-grapling.html#missing-data"><i class="fa fa-check"></i><b>1.2</b> Missing Data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>2</b> Statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistics.html"><a href="statistics.html#logistic-regression"><i class="fa fa-check"></i><b>2.1</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="statistics.html"><a href="statistics.html#matematyczna-interpretacja-modelu"><i class="fa fa-check"></i><b>2.1.1</b> Matematyczna interpretacja modelu</a></li>
<li class="chapter" data-level="2.1.2" data-path="statistics.html"><a href="statistics.html#graficzna-interpretacja-modelu"><i class="fa fa-check"></i><b>2.1.2</b> Graficzna interpretacja modelu</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistics.html"><a href="statistics.html#bayesian-statistics---introduction"><i class="fa fa-check"></i><b>2.2</b> Bayesian Statistics - Introduction</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="statistics.html"><a href="statistics.html#introduction"><i class="fa fa-check"></i><b>2.2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2.2" data-path="statistics.html"><a href="statistics.html#priors"><i class="fa fa-check"></i><b>2.2.2</b> Priors</a></li>
<li class="chapter" data-level="2.2.3" data-path="statistics.html"><a href="statistics.html#contrasts-and-comparison"><i class="fa fa-check"></i><b>2.2.3</b> Contrasts and comparison</a></li>
<li class="chapter" data-level="2.2.4" data-path="statistics.html"><a href="statistics.html#dealing-with-2-parameter-model"><i class="fa fa-check"></i><b>2.2.4</b> Dealing with 2 parameter model</a></li>
<li class="chapter" data-level="2.2.5" data-path="statistics.html"><a href="statistics.html#automatisation---best-package"><i class="fa fa-check"></i><b>2.2.5</b> Automatisation - BEST package</a></li>
<li class="chapter" data-level="2.2.6" data-path="statistics.html"><a href="statistics.html#conclusions"><i class="fa fa-check"></i><b>2.2.6</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="statistics.html"><a href="statistics.html#bayesian-statistics---intermediate"><i class="fa fa-check"></i><b>2.3</b> Bayesian Statistics - Intermediate</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="statistics.html"><a href="statistics.html#likelihood"><i class="fa fa-check"></i><b>2.3.1</b> Likelihood</a></li>
<li class="chapter" data-level="2.3.2" data-path="statistics.html"><a href="statistics.html#posterior"><i class="fa fa-check"></i><b>2.3.2</b> Posterior</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
#<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ksiega Lukasza</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Statistics</h1>
<div id="logistic-regression" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Logistic Regression</h2>
<p><a href="https://bookdown.org/yihui/rmarkdown/html-document.html"><em>Markdown
Tutorial</em></a></p>
<div id="matematyczna-interpretacja-modelu" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Matematyczna interpretacja modelu</h3>
<p>Quiz correct answers: d.Â Hint: <code>Remember</code>, the coefficient in a logistic
regression model is the expected increase in the log odds given a one
unit increase in the explanatory variable.</p>
<table>
<thead>
<tr class="header">
<th align="right">Survived</th>
<th align="right">Fare</th>
<th align="right">Fare_log</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">7.2500</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">71.2833</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">7.9250</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">53.1000</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">8.0500</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">8.4583</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>Wyliczanie modelu logistycznego.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="statistics.html#cb13-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>df_titanic, Survived <span class="sc">~</span> Fare_log, <span class="at">family =</span> <span class="st">&#39;binomial&#39;</span>)</span>
<span id="cb13-2"><a href="statistics.html#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="statistics.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model)  <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">caption=</span><span class="st">&#39;Table 1. Summary statistics for logistic regression model&#39;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-3">Table 2.1: </span>Table 1. Summary statistics for logistic regression model</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-2.3337286</td>
<td align="right">0.2452271</td>
<td align="right">-9.516601</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Fare_log</td>
<td align="right">0.6442428</td>
<td align="right">0.0792358</td>
<td align="right">8.130706</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Model wyliczany jest zgodnie z ponizsza formula
<img src="graph/model_logistic_regression.jpg" id="id" class="class" style="width:50.0%;height:50.0%" /></p>
<p>dlategp by otrzymac oszacowania paraemtrow w formie ich wpÅywu na odds
musimy je poddaÄ dziaÅaniu exp()</p>
<p><img src="graph/odds.jpg" class="class" style="width:50.0%;height:50.0%" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="statistics.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code></pre></div>
<pre><code>## (Intercept)    Fare_log 
##  -2.3337286   0.6442428</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="statistics.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tak przemnozone wspolczynniki interpretujemy nastepujaco:</span></span>
<span id="cb16-2"><a href="statistics.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  o ile % wzrosnie odds wystapienia zdarzenia jezeli wzrosnie nam wartosc predyktora o 1</span></span>
<span id="cb16-3"><a href="statistics.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="statistics.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(model))</span></code></pre></div>
<pre><code>## (Intercept)    Fare_log 
##  0.09693365  1.90454431</code></pre>
<p>Ponizej w sposob matematyczny pokazuje ze to wlasnie oznacza
interpretacja wzrostu parametra stajacego przy predyktorze.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="statistics.html#cb18-1" aria-hidden="true" tabindex="-1"></a>df_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(model, <span class="at">type.predict =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># without response argument, the fitted value will be on log-odds scale</span></span>
<span id="cb18-2"><a href="statistics.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="statistics.html#cb18-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">=</span> df_aug<span class="sc">$</span>.fitted[df_aug<span class="sc">$</span>Fare_log<span class="sc">==</span><span class="dv">3</span>][<span class="dv">1</span>]</span>
<span id="cb18-4"><a href="statistics.html#cb18-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> df_aug<span class="sc">$</span>.fitted[df_aug<span class="sc">$</span>Fare_log<span class="sc">==</span><span class="dv">2</span>][<span class="dv">1</span>]</span>
<span id="cb18-5"><a href="statistics.html#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="statistics.html#cb18-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">round</span>(p3<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p3)<span class="sc">/</span>(p2<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p2)),<span class="dv">5</span>)</span>
<span id="cb18-7"><a href="statistics.html#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="statistics.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># i sprawdzenie czy dobrze rozumiem zaleÅ¼nosc</span></span>
<span id="cb18-9"><a href="statistics.html#cb18-9" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">coef</span>(model))[<span class="st">&#39;Fare_log&#39;</span>],<span class="dv">5</span>)</span>
<span id="cb18-10"><a href="statistics.html#cb18-10" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">==</span>x</span></code></pre></div>
<pre><code>## Fare_log 
##     TRUE</code></pre>
<p>Prob for Fare_log = 2 was equal to 0.2601396 while for Fare_log = 3 was
equal to 0.401072. The odds increase by 1.90454. The same what model results
suggests -&gt; 1.90454.</p>
<p>Quiz</p>
<p>The fitted coefficient from the medical school logistic regression model
is 5.45. The exponential of this is 233.73.</p>
<p>Donaldâs GPA is 2.9, and thus the model predicts that the probability of
him getting into medical school is 3.26%. The odds of Donald getting
into medical school are 0.0337, orâphrased in gambling termsâ29.6:1.
If Donald hacks the schoolâs registrar and changes his GPA to 3.9, then
which of the following statements is FALSE:</p>
<p>Possible Answers</p>
<ol style="list-style-type: lower-alpha">
<li>His expected odds of getting into medical school improve to 7.8833
(or about 9:8).</li>
<li>His expected probability of getting into medical school improves to
88.7%.</li>
<li>His expected log-odds of getting into medical school improve by
5.45.</li>
<li>His expected probability of getting into medical school improves to
7.9%.</li>
</ol>
<p>Correct answers on the top of the page</p>
</div>
<div id="graficzna-interpretacja-modelu" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Graficzna interpretacja modelu</h3>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p><img src="graph/log_odds.jpg" class="class" style="width:50.0%;height:50.0%" /></p>
<p><img src="graph/comparison%20of%203%20scales.jpg" class="class" style="width:50.0%;height:50.0%" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="statistics.html#cb20-1" aria-hidden="true" tabindex="-1"></a>df_aug <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Survived_hat=</span><span class="fu">round</span>(.fitted)) <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="statistics.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Survived, Survived_hat) <span class="sc">%&gt;%</span> table</span></code></pre></div>
<pre><code>##         Survived_hat
## Survived   0   1
##        0 462  83
##        1 219 123</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="statistics.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Out of sample predictions</span></span>
<span id="cb22-2"><a href="statistics.html#cb22-2" aria-hidden="true" tabindex="-1"></a>DiCaprio<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Fare_log=</span><span class="dv">1</span>)</span>
<span id="cb22-3"><a href="statistics.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(model, <span class="at">newdata =</span> DiCaprio, <span class="at">type.predict =</span> <span class="st">&#39;response&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   Fare_log .fitted
##      &lt;dbl&gt;   &lt;dbl&gt;
## 1        1   0.156</code></pre>
</div>
</div>
<div id="bayesian-statistics---introduction" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Bayesian Statistics - Introduction</h2>
<div id="introduction" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Introduction</h3>
<p>The role of probability distributions in Bayesian data analysis is to
represent uncertainty, and the role of Bayesian inference is to update
these probability distributions to reflect what has been learned from
data.</p>
<p>Let say I want to set an advertisement on social media. They claim, adds
on their surface has 10% of clicks. I a bit sceptical and asses probable
efectivnes may range between 0 and 0.20. I assume that binomial model
will imitate process generating visitors. Binomial model is my
generative model then.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="statistics.html#cb24-1" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb24-2"><a href="statistics.html#cb24-2" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb24-3"><a href="statistics.html#cb24-3" aria-hidden="true" tabindex="-1"></a>proportion_clicks <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_samples, <span class="at">min =</span> <span class="fl">0.0</span>, <span class="at">max =</span> <span class="fl">0.2</span>)</span>
<span id="cb24-4"><a href="statistics.html#cb24-4" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n_samples, <span class="at">size =</span> n_ads_shown, <span class="at">prob =</span> proportion_clicks)</span>
<span id="cb24-5"><a href="statistics.html#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="statistics.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb24-7"><a href="statistics.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize proportion clicks</span></span>
<span id="cb24-8"><a href="statistics.html#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(proportion_clicks)</span>
<span id="cb24-9"><a href="statistics.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize n_visitors</span></span>
<span id="cb24-10"><a href="statistics.html#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(n_visitors)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>Below I present joint distribution over both the underlying proportion
of clicks and how many visitors I would get.</p>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>I ran my ad campaign, and 13 people clicked and visited your site when
the ad was shown a 100 times. I would now like to use this new
information to update the Bayesian model. The reason that we call it
posterior is because it represents the uncertainty after (that is,
posterior to) having included the information in the data.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="statistics.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the posterior data frame</span></span>
<span id="cb25-2"><a href="statistics.html#cb25-2" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span>
<span id="cb25-3"><a href="statistics.html#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="statistics.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize posterior proportion clicks - below I condition the joint distribution - of prior distribution of proportion_clicks and distribution of n_visitors </span></span>
<span id="cb25-5"><a href="statistics.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>proportion_clicks)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>Now we want to use this updated proportion_clicks to predict how many
visitors we would get if we reran the ad campaign.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="statistics.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign posterior to a new variable called prior</span></span>
<span id="cb26-2"><a href="statistics.html#cb26-2" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> posterior</span>
<span id="cb26-3"><a href="statistics.html#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="statistics.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look at the first rows in prior</span></span>
<span id="cb26-5"><a href="statistics.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(prior)</span></code></pre></div>
<pre><code>##     proportion_clicks n_visitors
## 23         0.11861989         13
## 33         0.09022809         13
## 61         0.06197847         13
## 85         0.14814361         13
## 90         0.15313361         13
## 104        0.16169598         13</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="statistics.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace prior$n_visitors with a new sample and visualize the result</span></span>
<span id="cb28-2"><a href="statistics.html#cb28-2" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span>  <span class="fu">nrow</span>(prior)</span>
<span id="cb28-3"><a href="statistics.html#cb28-3" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb28-4"><a href="statistics.html#cb28-4" aria-hidden="true" tabindex="-1"></a>prior<span class="sc">$</span>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_samples, <span class="at">size =</span> n_ads_shown, <span class="at">prob =</span> prior<span class="sc">$</span>proportion_clicks)</span>
<span id="cb28-5"><a href="statistics.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prior<span class="sc">$</span>n_visitors)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="priors" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Priors</h3>
<div id="beta-distribution" class="section level4" number="2.2.2.1">
<h4><span class="header-section-number">2.2.2.1</span> Beta distribution</h4>
<p>The Beta distribution is a useful probability distribution when you want
model uncertainty over a parameter bounded between 0 and 1. Here youâll
explore how the two parameters of the Beta distribution determine its
shape.</p>
<p>So the larger the shape parameters are, the more concentrated the beta
distribution becomes.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="statistics.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore using the rbeta function</span></span>
<span id="cb29-2"><a href="statistics.html#cb29-2" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n =</span> <span class="dv">1000000</span>, <span class="at">shape1 =</span> <span class="dv">1</span>, <span class="at">shape2 =</span> <span class="dv">1</span>)</span>
<span id="cb29-3"><a href="statistics.html#cb29-3" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n =</span> <span class="dv">1000000</span>, <span class="at">shape1 =</span> <span class="dv">100</span>, <span class="at">shape2 =</span> <span class="dv">100</span>)</span>
<span id="cb29-4"><a href="statistics.html#cb29-4" aria-hidden="true" tabindex="-1"></a>beta_3 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n =</span> <span class="dv">1000000</span>, <span class="at">shape1 =</span> <span class="dv">100</span>, <span class="at">shape2 =</span> <span class="dv">20</span>)</span>
<span id="cb29-5"><a href="statistics.html#cb29-5" aria-hidden="true" tabindex="-1"></a>beta_4 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n =</span> <span class="dv">1000000</span>, <span class="at">shape1 =</span> <span class="dv">5</span>, <span class="at">shape2 =</span> <span class="dv">95</span>)</span>
<span id="cb29-6"><a href="statistics.html#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="statistics.html#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="statistics.html#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="statistics.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb29-10"><a href="statistics.html#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta_1, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.02</span>), <span class="at">main =</span> <span class="st">&quot;shape1 = 1, shape2 = 1&quot;</span>)</span>
<span id="cb29-11"><a href="statistics.html#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta_2, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.02</span>), <span class="at">main =</span> <span class="st">&quot;shape1 = 100, shape2 = 100&quot;</span>)</span>
<span id="cb29-12"><a href="statistics.html#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta_3, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.02</span>), <span class="at">main =</span> <span class="st">&quot;shape1 = 100, shape2 = 20&quot;</span>)</span>
<span id="cb29-13"><a href="statistics.html#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta_4, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.02</span>), <span class="at">main =</span> <span class="st">&quot;shape1 = 5, shape2 = 95&quot;</span>)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>The 4th graphs represents the best following setence: <em>Most ads get
clicked on 5% of the time, but for some ads it is as low as 2% and for
others as high as 8%.</em></p>
</div>
</div>
<div id="contrasts-and-comparison" class="section level3" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Contrasts and comparison</h3>
<p>Let say, I initialize also text add campaign, get 6 visitors out of 100
views and now I want to compare which one video or text add is more cost
effective.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="statistics.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameters</span></span>
<span id="cb30-2"><a href="statistics.html#cb30-2" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb30-3"><a href="statistics.html#cb30-3" aria-hidden="true" tabindex="-1"></a>n_ads_shown <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb30-4"><a href="statistics.html#cb30-4" aria-hidden="true" tabindex="-1"></a>proportion_clicks <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_draws, <span class="at">min =</span> <span class="fl">0.0</span>, <span class="at">max =</span> <span class="fl">0.2</span>)</span>
<span id="cb30-5"><a href="statistics.html#cb30-5" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n_draws, <span class="at">size =</span> n_ads_shown, </span>
<span id="cb30-6"><a href="statistics.html#cb30-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> proportion_clicks)</span>
<span id="cb30-7"><a href="statistics.html#cb30-7" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(proportion_clicks, n_visitors)</span>
<span id="cb30-8"><a href="statistics.html#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="statistics.html#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the posteriors for video and text ads</span></span>
<span id="cb30-10"><a href="statistics.html#cb30-10" aria-hidden="true" tabindex="-1"></a>posterior_video <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">13</span>, ]</span>
<span id="cb30-11"><a href="statistics.html#cb30-11" aria-hidden="true" tabindex="-1"></a>posterior_text <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">6</span>, ]</span>
<span id="cb30-12"><a href="statistics.html#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="statistics.html#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the posteriors</span></span>
<span id="cb30-14"><a href="statistics.html#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior_video<span class="sc">$</span>proportion_clicks, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="statistics.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior_text<span class="sc">$</span>proportion_clicks, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-12-2.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="statistics.html#cb32-1" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">video_prop =</span> posterior_video<span class="sc">$</span>proportion_clicks[<span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>],</span>
<span id="cb32-2"><a href="statistics.html#cb32-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">text_prop =</span> posterior_text<span class="sc">$</span>proportion_click[<span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>])</span>
<span id="cb32-3"><a href="statistics.html#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="statistics.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior difference: video_prop - text_prop</span></span>
<span id="cb32-5"><a href="statistics.html#cb32-5" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>prop_diff <span class="ot">&lt;-</span> posterior<span class="sc">$</span>video_prop <span class="sc">-</span> posterior<span class="sc">$</span>text_prop </span>
<span id="cb32-6"><a href="statistics.html#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="statistics.html#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize prop_diff</span></span>
<span id="cb32-8"><a href="statistics.html#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>prop_diff)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-12-3.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="statistics.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the median of prop_diff</span></span>
<span id="cb33-2"><a href="statistics.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(posterior<span class="sc">$</span>prop_diff)</span></code></pre></div>
<pre><code>## [1] 0.06544415</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="statistics.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportion</span></span>
<span id="cb35-2"><a href="statistics.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(posterior<span class="sc">$</span>prop_diff <span class="sc">&gt;</span> <span class="fl">0.0</span>)</span></code></pre></div>
<pre><code>## [1] 0.9465</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="statistics.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Different adds have differnt costs then:</span></span>
<span id="cb37-2"><a href="statistics.html#cb37-2" aria-hidden="true" tabindex="-1"></a>visitor_spend <span class="ot">&lt;-</span> <span class="fl">2.53</span></span>
<span id="cb37-3"><a href="statistics.html#cb37-3" aria-hidden="true" tabindex="-1"></a>video_cost <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb37-4"><a href="statistics.html#cb37-4" aria-hidden="true" tabindex="-1"></a>text_cost <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb37-5"><a href="statistics.html#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="statistics.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the column posterior$video_profit</span></span>
<span id="cb37-7"><a href="statistics.html#cb37-7" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>video_profit <span class="ot">&lt;-</span> posterior<span class="sc">$</span>video_prop <span class="sc">*</span> visitor_spend <span class="sc">-</span> video_cost</span>
<span id="cb37-8"><a href="statistics.html#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="statistics.html#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the column posterior$text_profit</span></span>
<span id="cb37-10"><a href="statistics.html#cb37-10" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>text_profit <span class="ot">&lt;-</span> posterior<span class="sc">$</span>text_prop <span class="sc">*</span> visitor_spend <span class="sc">-</span> text_cost</span>
<span id="cb37-11"><a href="statistics.html#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="statistics.html#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the video_profit and text_profit columns</span></span>
<span id="cb37-13"><a href="statistics.html#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>video_profit)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-12-4.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="statistics.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>text_profit)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-12-5.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="statistics.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the column posterior$profit_diff</span></span>
<span id="cb39-2"><a href="statistics.html#cb39-2" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">$</span>profit_diff <span class="ot">&lt;-</span> posterior<span class="sc">$</span>video_profit <span class="sc">-</span> posterior<span class="sc">$</span>text_profit</span>
<span id="cb39-3"><a href="statistics.html#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="statistics.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize posterior$profit_diff</span></span>
<span id="cb39-5"><a href="statistics.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>profit_diff)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-12-6.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="statistics.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate a &quot;best guess&quot; for the difference in profits</span></span>
<span id="cb40-2"><a href="statistics.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(posterior<span class="sc">$</span>profit_diff)</span></code></pre></div>
<pre><code>## [1] -0.0344263</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="statistics.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability that text ads are better than video ads</span></span>
<span id="cb42-2"><a href="statistics.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(posterior<span class="sc">$</span>profit_diff <span class="sc">&lt;</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.6295</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="statistics.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#So it seems that the evidence does not strongly favor neither text nor video ads. But if forced to choose the text ads is better.</span></span></code></pre></div>
<div id="changeing-generative-model" class="section level4" number="2.2.3.1">
<h4><span class="header-section-number">2.2.3.1</span> Changeing Generative model</h4>
<p>Company has changed the way how they price adds. Now they take money
just for full day of exposition. Binomial model, which approximate
participation of succes in all trials (click in all views) is no longer
valid. For new scenario. <strong>Poison distribution</strong> is now needed.</p>
<p><strong>The Poison distribution takes only one parameter which is the mean
number of events per time unit</strong></p>
<p>In R you can simulate from a Poisson distribution using rpois where
lambda is the average number of occurrences:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="statistics.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the model according to instructions</span></span>
<span id="cb45-2"><a href="statistics.html#cb45-2" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb45-3"><a href="statistics.html#cb45-3" aria-hidden="true" tabindex="-1"></a>mean_clicks <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_draws, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">80</span>) <span class="co">#this is my prior</span></span>
<span id="cb45-4"><a href="statistics.html#cb45-4" aria-hidden="true" tabindex="-1"></a>n_visitors <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> n_draws, mean_clicks)</span>
<span id="cb45-5"><a href="statistics.html#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="statistics.html#cb45-6" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mean_clicks, n_visitors)</span>
<span id="cb45-7"><a href="statistics.html#cb45-7" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> prior[prior<span class="sc">$</span>n_visitors <span class="sc">==</span> <span class="dv">19</span>, ]</span>
<span id="cb45-8"><a href="statistics.html#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="statistics.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prior<span class="sc">$</span>mean_clicks)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="statistics.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior<span class="sc">$</span>mean_clicks)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-13-2.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</div>
</div>
<div id="dealing-with-2-parameter-model" class="section level3" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Dealing with 2 parameter model</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="statistics.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  the temperatures of Sweden water in 21 th of June in few following year</span></span>
<span id="cb47-2"><a href="statistics.html#cb47-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">23</span>,<span class="dv">20</span>,<span class="dv">17</span>,<span class="dv">23</span>)</span>
<span id="cb47-3"><a href="statistics.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the parameter grid - here are are my priors about the posible values of parameters of distribution</span></span>
<span id="cb47-4"><a href="statistics.html#cb47-4" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mu =</span> <span class="fu">seq</span>(<span class="dv">8</span>,<span class="dv">30</span>, <span class="at">by =</span> <span class="fl">0.5</span>), </span>
<span id="cb47-5"><a href="statistics.html#cb47-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sigma =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">10</span>, <span class="at">by=</span> <span class="fl">0.3</span>))</span>
<span id="cb47-6"><a href="statistics.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining and calculating the prior density for each parameter combination</span></span>
<span id="cb47-7"><a href="statistics.html#cb47-7" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>mu_prior <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(pars<span class="sc">$</span>mu, <span class="at">mean =</span> <span class="dv">18</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb47-8"><a href="statistics.html#cb47-8" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>sigma_prior <span class="ot">&lt;-</span> <span class="fu">dunif</span>(pars<span class="sc">$</span>sigma, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)</span>
<span id="cb47-9"><a href="statistics.html#cb47-9" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>prior <span class="ot">&lt;-</span> pars<span class="sc">$</span>mu_prior <span class="sc">*</span> pars<span class="sc">$</span>sigma_prior</span>
<span id="cb47-10"><a href="statistics.html#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the likelihood for each parameter combination</span></span>
<span id="cb47-11"><a href="statistics.html#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pars)) {</span>
<span id="cb47-12"><a href="statistics.html#cb47-12" aria-hidden="true" tabindex="-1"></a>  likelihoods <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(temp, pars<span class="sc">$</span>mu[i], pars<span class="sc">$</span>sigma[i])</span>
<span id="cb47-13"><a href="statistics.html#cb47-13" aria-hidden="true" tabindex="-1"></a>  pars<span class="sc">$</span>likelihood[i] <span class="ot">&lt;-</span> <span class="fu">prod</span>(likelihoods)</span>
<span id="cb47-14"><a href="statistics.html#cb47-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-15"><a href="statistics.html#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability of each parameter combination</span></span>
<span id="cb47-16"><a href="statistics.html#cb47-16" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>likelihood <span class="sc">*</span> pars<span class="sc">$</span>prior</span>
<span id="cb47-17"><a href="statistics.html#cb47-17" aria-hidden="true" tabindex="-1"></a>pars<span class="sc">$</span>probability <span class="ot">&lt;-</span> pars<span class="sc">$</span>probability <span class="sc">/</span> <span class="fu">sum</span>(pars<span class="sc">$</span>probability )</span>
<span id="cb47-18"><a href="statistics.html#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="statistics.html#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb47-20"><a href="statistics.html#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="fu">levelplot</span>(probability <span class="sc">~</span> mu <span class="sc">*</span> sigma, <span class="at">data =</span> pars)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>Whatâs likely the average water temperature for this lake on 20th of
Julys, and whatâs the probability the water temperature is going to be
18 or more on the next 20th?</p>
<p>Right now the posterior probability distribution is represented as a
data frame with one row per parameter combination with the corresponding
probability.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="statistics.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pars)</span></code></pre></div>
<pre><code>##     mu sigma   mu_prior sigma_prior       prior likelihood probability
## 1  8.0   0.1 0.01079819         0.1 0.001079819          0           0
## 2  8.5   0.1 0.01312316         0.1 0.001312316          0           0
## 3  9.0   0.1 0.01579003         0.1 0.001579003          0           0
## 4  9.5   0.1 0.01880982         0.1 0.001880982          0           0
## 5 10.0   0.1 0.02218417         0.1 0.002218417          0           0
## 6 10.5   0.1 0.02590352         0.1 0.002590352          0           0</code></pre>
<p>But my questions are much easier to answer if the posterior is
represented as a large number of samples, like in earlier chapters. So,
letâs draw a sample from this posterior.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="statistics.html#cb50-1" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pars), <span class="at">size=</span><span class="dv">10000</span>, <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span>pars<span class="sc">$</span>probability)</span>
<span id="cb50-2"><a href="statistics.html#cb50-2" aria-hidden="true" tabindex="-1"></a>pars_sample <span class="ot">&lt;-</span> pars[sample_indices,<span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>,<span class="st">&quot;sigma&quot;</span>)]</span>
<span id="cb50-3"><a href="statistics.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pars_sample)</span></code></pre></div>
<pre><code>##         mu sigma
## 1225  12.5   8.2
## 428   19.0   2.8
## 749   22.0   4.9
## 343   21.5   2.2
## 476   20.5   3.1
## 428.1 19.0   2.8</code></pre>
<p>What is probabibility of temperature being 18 or above? Not mean
temperature, the actual temperature.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="statistics.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rnorm is vectorized and implicitly loops over mu and sigma</span></span>
<span id="cb52-2"><a href="statistics.html#cb52-2" aria-hidden="true" tabindex="-1"></a>pred_temp<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean=</span>pars_sample<span class="sc">$</span>mu, <span class="at">sd=</span>pars_sample<span class="sc">$</span>sigma)</span>
<span id="cb52-3"><a href="statistics.html#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="statistics.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb52-5"><a href="statistics.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pars_sample<span class="sc">$</span>mu,<span class="dv">30</span>, <span class="at">main =</span> <span class="st">&#39;probability distribution of mean temperature&#39;</span>)</span>
<span id="cb52-6"><a href="statistics.html#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pred_temp,<span class="dv">30</span>, <span class="at">main =</span> <span class="st">&#39;probability distribution of tempeture&#39;</span> )</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="statistics.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pred_temp<span class="sc">&gt;=</span><span class="dv">18</span>)</span></code></pre></div>
<pre><code>## [1] 0.7359</code></pre>
</div>
<div id="automatisation---best-package" class="section level3" number="2.2.5">
<h3><span class="header-section-number">2.2.5</span> Automatisation - BEST package</h3>
<p>The Bayesian model behind BEST assumes that the generative model for the
data is a t-distribution; a more flexible distribution than the normal
distribution as it assumes that data points might be outliers to some
degree. This makes BESTâs estimate of the mean difference robust to
outliers in the data.</p>
<p>The t-distribution is just like the normal distribution, a generative
model with a mean and a standard deviation that generates heap shaped
data. The difference is that the t-distribution has an extra parameter,
sometimes called the degrees-of-freedom parameter, that governs how
likely the t-distribution is to generate outliers far from its center.</p>
<p>Another way in which BEST is different is that BEST uses a so-called
Markov chain Monte Carlo method to fit the model. Markov chain Monte
Carlo, or MCMC for short, returns a table of samples from the posterior,
we can work with the output just like before.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="statistics.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The IQ of zombies on a regular diet and a brain based diet.</span></span>
<span id="cb55-2"><a href="statistics.html#cb55-2" aria-hidden="true" tabindex="-1"></a>iq_brains <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">44</span>, <span class="dv">52</span>, <span class="dv">42</span>, <span class="dv">66</span>, <span class="dv">53</span>, <span class="dv">42</span>, <span class="dv">55</span>, <span class="dv">57</span>, <span class="dv">56</span>, <span class="dv">51</span>)</span>
<span id="cb55-3"><a href="statistics.html#cb55-3" aria-hidden="true" tabindex="-1"></a>iq_regular <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">44</span>, <span class="dv">34</span>, <span class="dv">18</span>, <span class="dv">51</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">49</span>, <span class="dv">48</span>, <span class="dv">46</span>)</span>
<span id="cb55-4"><a href="statistics.html#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="statistics.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean difference in IQ between the two groups</span></span>
<span id="cb55-6"><a href="statistics.html#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(iq_brains) <span class="sc">-</span> <span class="fu">mean</span>(iq_regular)</span></code></pre></div>
<pre><code>## [1] 9.3</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="statistics.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the BEST model to the data from both groups</span></span>
<span id="cb57-2"><a href="statistics.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BEST)</span></code></pre></div>
<pre><code>## Åadowanie wymaganego pakietu: HDInterval</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="statistics.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjags)</span></code></pre></div>
<pre><code>## Åadowanie wymaganego pakietu: coda</code></pre>
<pre><code>## Linked to JAGS 4.3.0</code></pre>
<pre><code>## Loaded modules: basemod,bugs</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="statistics.html#cb63-1" aria-hidden="true" tabindex="-1"></a>best_posterior <span class="ot">&lt;-</span> <span class="fu">BESTmcmc</span>(iq_brains, iq_regular)</span></code></pre></div>
<pre><code>## Waiting for parallel processing to complete...</code></pre>
<pre><code>## done.</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="statistics.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the model result</span></span>
<span id="cb66-2"><a href="statistics.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(best_posterior)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>Assume that a super smart mutant zombie (IQ = 150) got into the
iq_regular group by mistake. This might mess up the results as you and
your colleagues really were interested in how diet affects normal
zombies.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="statistics.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The IQ of zombies given a regular diet and a brain based diet.</span></span>
<span id="cb67-2"><a href="statistics.html#cb67-2" aria-hidden="true" tabindex="-1"></a>iq_brains <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">44</span>, <span class="dv">52</span>, <span class="dv">42</span>, <span class="dv">66</span>, <span class="dv">53</span>, <span class="dv">42</span>, <span class="dv">55</span>, <span class="dv">57</span>, <span class="dv">56</span>, <span class="dv">51</span>)</span>
<span id="cb67-3"><a href="statistics.html#cb67-3" aria-hidden="true" tabindex="-1"></a>iq_regular <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">44</span>, <span class="dv">34</span>, <span class="dv">18</span>, <span class="dv">51</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">49</span>, <span class="dv">48</span>, </span>
<span id="cb67-4"><a href="statistics.html#cb67-4" aria-hidden="true" tabindex="-1"></a>                <span class="dv">150</span>) <span class="co"># &lt;- Mutant zombie</span></span>
<span id="cb67-5"><a href="statistics.html#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="statistics.html#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the data above and calculate the difference in means</span></span>
<span id="cb67-7"><a href="statistics.html#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(iq_brains) <span class="sc">-</span> <span class="fu">mean</span>(iq_regular)</span></code></pre></div>
<pre><code>## [1] -1.1</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="statistics.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the BEST model to the modified data and plot the result</span></span>
<span id="cb69-2"><a href="statistics.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BEST)</span>
<span id="cb69-3"><a href="statistics.html#cb69-3" aria-hidden="true" tabindex="-1"></a>best_posterior <span class="ot">&lt;-</span> <span class="fu">BESTmcmc</span>(iq_brains, iq_regular)</span></code></pre></div>
<pre><code>## Waiting for parallel processing to complete...done.</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="statistics.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(best_posterior)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="conclusions" class="section level3" number="2.2.6">
<h3><span class="header-section-number">2.2.6</span> Conclusions</h3>
<p>Bayes allows you to tweak, change and tinker with the model to better
fit the data analytical problem you have. But a last reason to use Bayes
is because it is optimal, kind of. It can be shown, theoretically, that
no other method learns as efficiently from data as Bayesian inference.</p>
<p>In above examples I show what Bayesian model is about: * I describe my
expectations of proportion_clicks as uniform distribution (prior) *
Then i describe a generative model which will be responsible for
generating views based on proportion_clicks - the second source of
variability. For this aim I use two diffrent distribution - binomial and
poison - depending on specifity of exercise. * I was able to say which
add wass better, more, I was able to say which add was better in
probability way.</p>
</div>
</div>
<div id="bayesian-statistics---intermediate" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Bayesian Statistics - Intermediate</h2>
<div id="likelihood" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Likelihood</h3>
<p>On the example of poll. Imagine I am taking part in election to local
goverment. Based on many historical election poles I can count on 45% of
votes. Votes chances are approximate by bheta function.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="statistics.html#cb72-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">sample=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>),</span>
<span id="cb72-2"><a href="statistics.html#cb72-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">density=</span><span class="fu">dbeta</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>),<span class="at">shape1=</span><span class="dv">45</span>,<span class="at">shape2=</span><span class="dv">55</span>))</span>
<span id="cb72-3"><a href="statistics.html#cb72-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>sample,<span class="at">y=</span>density))<span class="sc">+</span></span>
<span id="cb72-4"><a href="statistics.html#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb72-5"><a href="statistics.html#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Density function&quot;</span>)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>Lets imagine that i receive 60% of votes in ellection pole. I can assume
that binomial distribution is well suited for generative model
responsible for how many votes I am geting. Then I may ask myself:
**How probable would be obtaining such a results (60%) of votes under
different succes_rate (paramter of Binomial distribution).</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="statistics.html#cb73-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">likelihood=</span><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">6</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)), </span>
<span id="cb73-2"><a href="statistics.html#cb73-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">parameter_p=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))</span>
<span id="cb73-3"><a href="statistics.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="statistics.html#cb73-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>parameter_p,<span class="at">y=</span>likelihood))<span class="sc">+</span></span>
<span id="cb73-5"><a href="statistics.html#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb73-6"><a href="statistics.html#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Likelihood distribution over different succes_rate parameters&quot;</span>)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>The likelihood function summarizes the likelihood of observing polling
data X under different values of the underlying support parameter p.
Thus, the likelihood is a function of p that depends upon the observed
data X</p>
</div>
<div id="posterior" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Posterior</h3>
<p>Since Iâve got the prior &amp; likelihood:</p>
<ul>
<li><p>prior: let say based on the historical pole % of votes I can count
on is described by betha distribution Betha(45.55) â&gt; most
probable is geting 45% votes</p></li>
<li><p>likelihood: is denoting to the most recent data shown above</p></li>
</ul>
<p>I can approach now to modeling <strong>posterior model of p</strong> According to
Bayes rules posterior is calculating by:</p>
<p><em>posterior</em> = prior * likelihood</p>
<p>However, in more sophisticated model settings, tidy, closed-form
solutions to this formula might not exist. Very loosely speaking, the
goal here is to send information out to the JAGS program, which will
then design an algorithm to sample from the posterior, based on which I
will then simulate the posterior.</p>
<div id="compiling-rjags-model" class="section level4" number="2.3.2.1">
<h4><span class="header-section-number">2.3.2.1</span> Compiling rjags model</h4>
<p>Built from previous polls &amp; election data, my prior model of is a
Beta(,) with shape parameters a=45 and b=55. For added insight into
<strong>p</strong>, I also polled potential voters. The dependence of X, the number
of these voters that support you, on <strong>p</strong> is modeled by the
Bin(<strong>n</strong>,<strong>p</strong>) distribution.</p>
<p>In the completed poll, X=6 of n=10 voters supported you. The next goal
is to update my model of in light of these observed polling data! To
this end, I will use the rjags package to approximate the posterior
model of . This exercise will be break down into the 3 rjags steps:
define, compile, simulate.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="statistics.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb74-2"><a href="statistics.html#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="statistics.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># DEFINE the model</span></span>
<span id="cb74-4"><a href="statistics.html#cb74-4" aria-hidden="true" tabindex="-1"></a>vote_model <span class="ot">&lt;-</span> <span class="st">&quot;model{</span></span>
<span id="cb74-5"><a href="statistics.html#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="st">    # Likelihood model for X</span></span>
<span id="cb74-6"><a href="statistics.html#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="st">    X ~ dbin(p, n)</span></span>
<span id="cb74-7"><a href="statistics.html#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb74-8"><a href="statistics.html#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="st">    # Prior model for p</span></span>
<span id="cb74-9"><a href="statistics.html#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="st">    p ~ dbeta(a, b)</span></span>
<span id="cb74-10"><a href="statistics.html#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb74-11"><a href="statistics.html#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="statistics.html#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE the model    </span></span>
<span id="cb74-13"><a href="statistics.html#cb74-13" aria-hidden="true" tabindex="-1"></a>vote_jags <span class="ot">&lt;-</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(vote_model), </span>
<span id="cb74-14"><a href="statistics.html#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">45</span>, <span class="at">b =</span> <span class="dv">55</span>, <span class="at">X =</span> <span class="dv">6</span>, <span class="at">n =</span> <span class="dv">10</span>),</span>
<span id="cb74-15"><a href="statistics.html#cb74-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">inits =</span> <span class="fu">list</span>(<span class="at">.RNG.name =</span> <span class="st">&quot;base::Wichmann-Hill&quot;</span>, <span class="at">.RNG.seed =</span> <span class="dv">100</span>))</span></code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 1
##    Unobserved stochastic nodes: 1
##    Total graph size: 5
## 
## Initializing model</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="statistics.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMULATE the posterior</span></span>
<span id="cb76-2"><a href="statistics.html#cb76-2" aria-hidden="true" tabindex="-1"></a>vote_sim <span class="ot">&lt;-</span> <span class="fu">coda.samples</span>(<span class="at">model =</span> vote_jags, <span class="at">variable.names =</span> <span class="fu">c</span>(<span class="st">&quot;p&quot;</span>), <span class="at">n.iter =</span> <span class="dv">10000</span>)</span>
<span id="cb76-3"><a href="statistics.html#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="statistics.html#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT the posterior</span></span>
<span id="cb76-5"><a href="statistics.html#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vote_sim, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="3_Statistics_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-grapling.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
